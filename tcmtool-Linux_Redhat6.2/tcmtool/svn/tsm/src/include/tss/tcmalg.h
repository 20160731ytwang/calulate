/************************************************************
ï¿½Ä¼ï¿½ï¿½ï¿½ï¿½ï¿½tcmalg.h
ï¿½ï¿½Ó¿â£ºtcmalg.lib(ï¿½ï¿½Ì¬)
Ëµï¿½ï¿½ï¿½ï¿½Ã¿ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä·ï¿½ï¿½ï¿½Öµï¿½ï¿½Ê¾ï¿½Äºï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ü²ï¿½Ò»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ëµï¿½ï¿½ï¿½ï¿½ï¿½Î¿ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä¶ï¿½ï¿½ï¿½Ëµï¿½ï¿½
ï¿½æ±¾ï¿½Þ¶ï¿½ï¿½ï¿½: linyang
Ê±ï¿½ä£º
  2006.12.18
       ï¿½ï¿½ï¿½ï¿½schï¿½ï¿½releaseï¿½æ±¾ï¿½Â³ï¿½ï¿½ï¿½.
	   ï¿½ï¿½ï¿½ï¿½eccï¿½ï¿½ï¿½Ü´ï¿½ï¿½ï¿½32ï¿½Ö½Úµï¿½ï¿½ï¿½ï¿½Ý³ï¿½ï¿½ï¿½
  2006.12.18
      Ê¹ï¿½Ã¶ï¿½Ì¬ï¿½ï¿½ï¿½cï¿½ï¿½ï¿½Ô¿ï¿½(msvcrt.dll/msvcr71.dll)
  2006.12.21
		ÎªÖ§ï¿½Ö¶ï¿½ï¿½ß³Ì£ï¿½ï¿½ï¿½sms4ï¿½ï¿½ï¿½ï¿½ï¿½Ðµï¿½È«ï¿½ï¿½ï¿½ï¿½Ô¿Îªï¿½Ö²ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
		ï¿½ï¿½ï¿½ï¿½Ä£Ê½ï¿½ï¿½Õ»ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
		É¾ï¿½ï¿½ï¿½ï¿½Ê¼ï¿½ï¿½sms4ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½
  2006.12.25
		ÎªÖ§ï¿½Ö²ï¿½ï¿½ï¿½firmwareï¿½ï¿½ï¿½ï¿½Ô¿Ð­ï¿½Ì¹ï¿½ï¿½Ü£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô¿Ð­ï¿½Ì¹ï¿½ï¿½Üºï¿½ï¿½ï¿½ï¿½ï¿½
		ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¹ï¿½Ã£ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Í¾ï¿½ï¿½ï¿½ï¿½Ö§ï¿½ï¿½256bitï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ß£ï¿½ï¿½ï¿½Ö§ï¿½ï¿½192ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
  2006.12.31
		ÎªÖ§ï¿½Ö²ï¿½ï¿½ï¿½ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½Ç·ï¿½Æ¥ï¿½ä£¬ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ó¿ï¿½ï¿½ï¿½ï¿½Ú²ï¿½ï¿½Ô¡ï¿½
		tcm_ecc_is_key_match ï¿½ï¿½ï¿½Ú²ï¿½ï¿½Ô¹ï¿½Ë½Ô¿ï¿½Ç·ï¿½Æ¥ï¿½ï¿½
		tcm_ecc_point_from_privatekey ï¿½ï¿½ï¿½Ú´Ó¹ï¿½Ô¿ï¿½Ãµï¿½Ë½Ô¿
		ï¿½ï¿½ï¿½ï¿½Ö§ï¿½ï¿½256ï¿½ï¿½ï¿½ß¡ï¿½
  2007.1.5
		ï¿½Þ¸ï¿½ï¿½ï¿½ï¿½ÉµÄ´ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½32ï¿½Ö½Ú¶ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
  2007.3.29
		Ô­ï¿½ï¿½ï¿½ï¿½SMS4Ö»ï¿½Ü¼ï¿½ï¿½ï¿½512ï¿½Ö½Ú³ï¿½ï¿½Èµï¿½ï¿½ï¿½ï¿½Ä¡ï¿½ï¿½ï¿½ï¿½ï¿½È¡ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Æ¡ï¿½
************************************************************/


#ifndef HEADER_TCM_ALG_H
#define HEADER_TCM_ALG_H


#ifdef	__cplusplus
extern "C" {
#endif

// #ifndef BOOL
// typedef int BOOL;
// #endif

#define TCM_SCH_160_HASH_LEN	 0x14
#define TCM_SCH_192_HASH_LEN	 0x18
#define TCM_SCH_256_HASH_LEN	 0x20
/*************************************************************************
ï¿½ï¿½Ô²ï¿½ï¿½ï¿½ß³ï¿½Ê¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_init()
ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_ecc_init();

/*************************************************************************
ï¿½ï¿½Ô²ï¿½ï¿½ï¿½ï¿½ï¿½Í·ï¿½ï¿½ï¿½Ô´ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_release()
ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_ecc_release();


/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½Ä¼ï¿½ï¿½ï¿½ï¿½ã·¨
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_encrypt()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
		plaintext:		ï¿½ï¿½ï¿½Äµï¿½Ö·
		uPlaintextLen:	ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½
		pubkey:			ï¿½ï¿½Ô¿ï¿½ï¿½Ö·
		uPubkeyLenï¿½ï¿½	ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½
		puCiphertextLenï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ciphertextï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä´ï¿½Ð¡
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		ciphertext: ï¿½ï¿½ï¿½Äµï¿½Ö·
		puCiphertextLen : ï¿½ï¿½ï¿½Ä³ï¿½ï¿½Èµï¿½Ö·Ö¸ï¿½ë£¬Ö¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½Ü³É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_ecc_encrypt(unsigned char *plaintext, unsigned int uPlaintextLen, unsigned char *pubkey, unsigned int uPubkeyLen, unsigned char *ciphertext, unsigned int *puCiphertextLen);

/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½Ä½ï¿½ï¿½ï¿½ï¿½ã·¨
func : tcm_ecc_decrypt()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 		ciphertext:		ï¿½ï¿½ï¿½Äµï¿½Ö·
		uCiphertextLen:	ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½
		prikey:			Ë½Ô¿ï¿½ï¿½Ö·
		uPrikeyLenï¿½ï¿½	Ë½Ô¿ï¿½ï¿½ï¿½ï¿½
		puPlaintextLen: ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½plaintextï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä´ï¿½Ð¡

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		plaintext:		ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
		puCiphertextLen : ï¿½ï¿½ï¿½Ä³ï¿½ï¿½Èµï¿½Ö·Ö¸ï¿½ë£¬Ö¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½Ü³É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_ecc_decrypt(unsigned char *ciphertext, unsigned int uCiphertextLen, unsigned char *prikey, unsigned int uPrikeyLen, unsigned char *plaintext, unsigned int *puPlaintextLen);

/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½ï¿½Ô²ï¿½ï¿½ï¿½ßµï¿½ï¿½ï¿½ï¿½ï¿½Ç©ï¿½ï¿½ï¿½ã·¨
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_signature()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 		digest:			ï¿½ï¿½Òªï¿½ï¿½Ç©ï¿½ï¿½ï¿½ï¿½ÕªÒª
		uDigestLen:		ÕªÒªï¿½ï¿½ï¿½ï¿½
		prikey:			Ë½Ô¿ï¿½ï¿½Ö·
		uPrikeyLenï¿½ï¿½	Ë½Ô¿ï¿½ï¿½ï¿½ï¿½
		puSigLen:		ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½sigï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ð¡

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		sig:			ï¿½ï¿½ï¿½ï¿½Ç©ï¿½ï¿½
		puSigLen:		Ç©ï¿½ï¿½ï¿½ï¿½ï¿½Èµï¿½Ö·Ö¸ï¿½ë£¬Ö¸ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ç©ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½Ç©ï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_ecc_signature( unsigned char *digest, unsigned int uDigestLen,
					   unsigned char *prikey, unsigned int uPrikeyLen, 
					   /*out*/unsigned char *sig,
					   /*out*/unsigned int *puSigLen);

/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½ï¿½Ô²ï¿½ï¿½ï¿½ßµï¿½ï¿½ï¿½ï¿½ï¿½Ç©ï¿½ï¿½ï¿½ï¿½Ö¤ï¿½ã·¨
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_verify()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 		digest:			ï¿½ï¿½Òªï¿½ï¿½Ç©ï¿½ï¿½ï¿½ï¿½ÕªÒª
		uDigestLen:		ÕªÒªï¿½ï¿½ï¿½ï¿½
		sig:			Ç©ï¿½ï¿½
		uSigLen:		Ç©ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½
		pubkey:			ï¿½ï¿½Ô¿
		uPubkeyLen:		ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		ï¿½ï¿½ï¿½Þ£ï¿½

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½Ö¤ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_ecc_verify(unsigned char *digest, unsigned int uDigestLen, unsigned char *sig, unsigned int uSigLen, unsigned char *pubkey, unsigned int uPubkeyLen);



/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½ï¿½Ô²ï¿½ï¿½ï¿½ßµï¿½ï¿½Ð¶Ï±ï¿½ï¿½Ø´ï¿½ï¿½Ç·ï¿½ï¿½ï¿½Ê¾ï¿½ï¿½ï¿½ï¿½ï¿½Ïµï¿½Ò»ï¿½ï¿½ï¿½ã£¬
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_is_point_valid()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 		point:			ï¿½ï¿½Ô²ï¿½ï¿½ï¿½ï¿½ï¿½ÏµÄµã£¬ï¿½ï¿½ï¿½ï¿½ï¿½Ç·ï¿½Ñ¹ï¿½ï¿½ï¿½ï¿½Ê½
		uPointLen:		ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		ï¿½ï¿½ï¿½Þ£ï¿½

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½Ö¤ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½TRUEï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½FALSE
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¹ï¿½ï¿½tcm_ecc_point_to_uncompressedï¿½ï¿½ï¿½ï¿½ï¿½Ãµï¿½ï¿½ï¿½Ñ¹ï¿½ï¿½ï¿½ï¿½Ê½ï¿½Ä´ï¿½
*************************************************************************/
unsigned char tcm_ecc_is_point_valid(unsigned char *point, unsigned int uPointLen);


/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½ï¿½Ô²ï¿½ï¿½ï¿½ßµï¿½ï¿½Ð¶Ï±ï¿½ï¿½Ø´ï¿½ï¿½Ç·ï¿½ï¿½ï¿½Ê¾ï¿½ï¿½ï¿½ï¿½ï¿½Ïµï¿½Ò»ï¿½ï¿½ï¿½ã£¬ï¿½ï¿½ï¿½ï¿½ï¿½Ç£ï¿½×ªï¿½ï¿½Îªï¿½ï¿½Ñ¹ï¿½ï¿½ï¿½ï¿½Ê½
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_point_to_uncompressed()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 		point:			ï¿½ï¿½Ô²ï¿½ï¿½ï¿½ï¿½ï¿½ÏµÄµï¿½
		uPointLen:		ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½
		puUncompressedpointLenï¿½ï¿½	ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½uncompressedpointï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ð¡Ö¸ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		uncompressedpoint:			ï¿½ï¿½ï¿½Ä·ï¿½Ñ¹ï¿½ï¿½ï¿½ï¿½Ê½
		puUncompressedpointLenï¿½ï¿½	ï¿½ï¿½ï¿½ï¿½uncompressedpointï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½×ªï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½TRUEï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½FALSE
*************************************************************************/
unsigned char tcm_ecc_point_to_uncompressed(unsigned char *point, unsigned int uPointLen,
								unsigned char *uncompressedpoint, unsigned int *puUncompressedpointLen);


/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½ï¿½Ô²ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½ï¿½Éºï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_genkey()

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
		ï¿½ï¿½ï¿½Þ£ï¿½
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 		prikey:			Ë½Ô¿
		puPrikeyLen:	Ë½Ô¿ï¿½ï¿½Ö·
		pubkey:			ï¿½ï¿½Ô¿
		puPubkeyLen:	ï¿½ï¿½Ô¿ï¿½ï¿½Ö·	

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_ecc_genkey(unsigned char *prikey, unsigned int *puPrikeyLen, unsigned char *pubkey, unsigned int *puPubkeyLen);



/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½Ä¹ï¿½ï¿½ê½»ï¿½ï¿½ï¿½ï¿½Ô¿ï¿½ã·¨ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½firmwareï¿½Ä²ï¿½ï¿½Ôºï¿½ï¿½ï¿½ï¿½ï¿½Ö»ï¿½ï¿½ï¿½ï¿½256bitï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_exchange()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
		fA:				ï¿½ï¿½ÎªTRUEÊ±ï¿½ï¿½Îªï¿½ï¿½ï¿½ð·½£ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½Ó¦ï¿½ï¿½
		prikey_Aï¿½ï¿½		
						ï¿½ï¿½faÎªTRUEÊ±ï¿½ï¿½Îªï¿½ï¿½ï¿½ð·½µÄ¾ï¿½Ì¬ï¿½ï¿½Ô¿Ë½Ô¿ï¿½ï¿½
						ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½Ó¦ï¿½ï¿½ï¿½Ä¾ï¿½Ì¬ï¿½ï¿½Ô¿Ë½Ô¿ï¿½ï¿½
		pubkey_Aï¿½ï¿½
						ï¿½ï¿½faÎªTRUEÊ±ï¿½ï¿½Îªï¿½ï¿½ï¿½ð·½µÄ¾ï¿½Ì¬ï¿½ï¿½Ô¿ï¿½ï¿½Ô¿ï¿½ï¿½
						ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½Ó¦ï¿½ï¿½ï¿½Ä¾ï¿½Ì¬ï¿½ï¿½Ô¿ï¿½ï¿½Ô¿ï¿½ï¿½
		prikey_RAï¿½ï¿½		
						ï¿½ï¿½faÎªTRUEÊ±ï¿½ï¿½Îªï¿½ï¿½ï¿½ð·½µï¿½ï¿½ï¿½Ê±ï¿½ï¿½Ô¿Ë½Ô¿ï¿½ï¿½
						ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½Ó¦ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê±ï¿½ï¿½Ô¿Ë½Ô¿ï¿½ï¿½
		pubkey_RA
						ï¿½ï¿½faÎªTRUEÊ±ï¿½ï¿½Îªï¿½ï¿½ï¿½ð·½µï¿½ï¿½ï¿½Ê±ï¿½ï¿½Ô¿ï¿½ï¿½Ô¿ï¿½ï¿½
						ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½Ó¦ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê±ï¿½ï¿½Ô¿ï¿½ï¿½Ô¿ï¿½ï¿½
		pubkey_B
						ï¿½ï¿½faÎªTRUEÊ±ï¿½ï¿½Îªï¿½ï¿½Ó¦ï¿½ï¿½ï¿½Ä¾ï¿½Ì¬ï¿½ï¿½Ô¿ï¿½ï¿½Ô¿ï¿½ï¿½
						ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½ï¿½ð·½µÄ¾ï¿½Ì¬ï¿½ï¿½Ô¿ï¿½ï¿½Ô¿ï¿½ï¿½
		pubkey_RB
						ï¿½ï¿½faÎªTRUEÊ±ï¿½ï¿½Îªï¿½ï¿½Ó¦ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê±ï¿½ï¿½Ô¿ï¿½ï¿½Ô¿ï¿½ï¿½
						ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½ï¿½ð·½µï¿½ï¿½ï¿½Ê±ï¿½ï¿½Ô¿ï¿½ï¿½Ô¿ï¿½ï¿½
		Za
						ï¿½í¾ší¿·ï¿½ï¿½Ã»ï¿½ï¿½ï¿½ÕªÒªï¿½ï¿½Ï¢
		Zb
						ï¿½ï¿½Ó¦ï¿½ï¿½ï¿½Ã»ï¿½ï¿½ï¿½ÕªÒªï¿½ï¿½Ï¢
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
 						
		key				ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô¿
		S1 
						ï¿½ï¿½faÎªTRUEÊ±ï¿½ï¿½Îªï¿½ï¿½Ó¦ï¿½ï¿½ï¿½ï¿½S1ï¿½ï¿½
						ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½ï¿½ð·½µï¿½SBï¿½ï¿½
		Sa
						ï¿½ï¿½faÎªTRUEÊ±ï¿½ï¿½Îªï¿½ï¿½Ó¦ï¿½ï¿½ï¿½ï¿½Saï¿½ï¿½
						ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Îªï¿½ï¿½ï¿½ð·½µï¿½S2ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_ecc_exchange(unsigned char fA,
					 unsigned char prikey_A[32], unsigned char pubkey_A[65],
					 unsigned char prikey_RA[32], unsigned char pubkey_RA[65],
					 unsigned char pubkey_B[65], unsigned char pubkey_RB[65], 
					 unsigned char Za[32], unsigned char Zb[32],
					 /*out*/unsigned char key[16],
					 /*out*/unsigned char S1[32], 
					 /*out*/unsigned char Sa[32]
					 );
/************************************************************************************/


/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½ï¿½Ô²ï¿½ï¿½ï¿½ßµÄ´ï¿½Ë½Ô¿ï¿½Ãµï¿½ï¿½ï¿½Ô¿
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_point_from_privatekey()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 		prikey:			Ë½Ô¿
		uPrikeyLen:		Ë½Ô¿ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		pubkey:			ï¿½ï¿½Ô¿
		puPubkeyLen:	ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_ecc_point_from_privatekey(const unsigned char *prikey, const unsigned int uPrikeyLen, unsigned char *pubkey, unsigned int *puPubkeyLen);

/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ECï¿½ï¿½Ô²ï¿½ï¿½ï¿½ßµï¿½ï¿½Ð¶Ï¹ï¿½Ë½Ô¿ï¿½ï¿½ï¿½Ç·ï¿½Æ¥ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ : tcm_ecc_is_match()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 		prikey:			ï¿½ï¿½Ô²ï¿½ï¿½ï¿½ï¿½ï¿½ÏµÄµã£¬ï¿½ï¿½ï¿½ï¿½ï¿½Ç·ï¿½Ñ¹ï¿½ï¿½ï¿½ï¿½Ê½
		uPrikeyLen:		Ë½Ô¿ï¿½ï¿½ï¿½ï¿½
		pubkey:			ï¿½ï¿½Ô¿
		uPubkeyLen:		ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		ï¿½ï¿½ï¿½Þ£ï¿½

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½TRUEï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½FALSE
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö»ï¿½ï¿½ï¿½Ú²ï¿½ï¿½Ô¡ï¿½
*************************************************************************/
unsigned char tcm_ecc_is_key_match(const unsigned char *prikey, const unsigned int uPrikeyLen, 
						  const unsigned char *pubkey, const unsigned int uPubkeyLen);

/************************************************************************************/
/************************************************************************************/
/* schï¿½ï¿½ï¿½ï¿½ */
// #ifndef uint8
// #define uint8  unsigned char
// #endif
// 
// #ifndef uint32
// #define uint32 unsigned long int
// #endif

typedef struct
{
    unsigned char total[2];
    unsigned long int state[8];
    unsigned char buffer[64];
}
sch_context;

/* sch */
void tcm_sch_starts( sch_context *ctx );
void tcm_sch_update( sch_context *ctx, unsigned char *input, unsigned int length );
void tcm_sch_finish( sch_context *ctx, unsigned char digest[32] );

/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ : tcm_sch_hash()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
		length:		ï¿½ï¿½Ï¢ï¿½ï¿½ï¿½ï¿½
		input:		ï¿½ï¿½Ï¢

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		digest:			ï¿½ï¿½ï¿½ï¿½HASHÖµ
ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_sch_hash( unsigned int datalen_in, unsigned char *pdata_in, unsigned char digest[32]);


/*************************************************************************
hmacï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ : tcm_hmac()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
		text:			ï¿½ï¿½Ï¢
		text_len:		ï¿½ï¿½Ï¢ï¿½ï¿½ï¿½ï¿½
 		key:			ï¿½ï¿½Ô¿
		key_len:		ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		digest:			ï¿½ï¿½ï¿½ï¿½HMACÖµ

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_hmac(unsigned char *text, unsigned int text_len, unsigned char *key, unsigned int key_len, unsigned char digest[32]);


/*************************************************************************
ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
ï¿½ï¿½ï¿½ï¿½ : tcm_kdf()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
		klen:			ï¿½ï¿½Òªï¿½ï¿½ï¿½ï¿½ï¿½Ä³ï¿½ï¿½È£ï¿½ï¿½ï¿½ï¿½ï¿½Ç°ï¿½ï¿½ï¿½ï¿½Îªmaskï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½klenï¿½Ä¿Õ¼ï¿½
		msgLen:			ï¿½ï¿½Ï¢ï¿½ï¿½ï¿½ï¿½
 		z:				ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ï¢
		zlen:			zï¿½Ä³ï¿½ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		mask:			ï¿½ï¿½ï¿½ï¿½ï¿½Ä»ï¿½ï¿½ï¿½ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_kdf(/*out*/unsigned char *mask, /*in*/int klen, /*in*/unsigned char *z, /*in*/ int zlen);


/*************************************************************************
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ï¢ï¿½ï¿½hashÖµ
ï¿½ï¿½ï¿½ï¿½ : tcm_get_message_hash()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
		msg:			ï¿½ï¿½Ï¢
		msgLen:			ï¿½ï¿½Ï¢ï¿½ï¿½ï¿½ï¿½
 		userID:			ï¿½Ã»ï¿½ï¿½ï¿½Ï¢
		uUserIDLen:		ï¿½Ã»ï¿½ï¿½ï¿½Ï¢ï¿½ï¿½ï¿½ï¿½
		pubkey:			ï¿½ï¿½Ô¿ï¿½ï¿½Ö·
		uPubkeyLen:		ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½
		puDigestLen:	ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½digestï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ð¡

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		digest:			ï¿½ï¿½ï¿½ï¿½ÕªÒª
		puDigestLen;	ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½digestï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_get_message_hash(unsigned char *msg, unsigned int msgLen,  
					   unsigned char  *userID, unsigned short int uUserIDLen, 
					   unsigned char *pubkey, unsigned int uPubkeyLen,
					   unsigned char *digest,
					   unsigned int *puDigestLen);


/*************************************************************************
ï¿½ï¿½ï¿½ï¿½Zaï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ê¹ï¿½ï¿½256bitsï¿½ï¿½HASHï¿½ã·¨
ï¿½ï¿½ï¿½ï¿½ : tcm_get_usrinfo_value()
ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½  
 		userID:			ï¿½Ã»ï¿½ï¿½ï¿½Ï¢
		uUserIDLen:		ï¿½Ã»ï¿½ï¿½ï¿½Ï¢ï¿½ï¿½ï¿½ï¿½
		pubkey:			ï¿½ï¿½Ô¿ï¿½ï¿½Ö·
		uPubkeyLen:		ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½

ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ 
		digest:			ï¿½ï¿½ï¿½ï¿½ÕªÒª

ï¿½ï¿½ï¿½ï¿½Öµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½É¹ï¿½ï¿½ï¿½ï¿½ï¿½0ï¿½ï¿½ï¿½ï¿½ï¿½ò·µ»ï¿½1
*************************************************************************/
int tcm_get_usrinfo_value(
					   unsigned char *userID, unsigned short int uUserIDLen, 
					   unsigned char *pubkey, unsigned int uPubkeyLen,
					   unsigned char digest[32]);


/************************************************************************************/
/************************************************************************************/
/************************************************************************************/
/* sms4ï¿½Ó½âº¯ï¿½ï¿½ */


// #ifndef UINT8
// typedef unsigned char       UINT8;
// #endif
// 
// #ifndef UINT32
// typedef unsigned int        UINT32;
// #endif
// 
// 
// #ifndef INT32
// typedef signed int          INT32;
// #endif
// 
// 
// #ifndef BYTE
// typedef unsigned char       BYTE;
// #endif

/* sms4ï¿½Ä¿é³¤ */
#define	SMS4_BLOCK_SIZE 16
/* sms4ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Üµï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ö½Ú³ï¿½ï¿½È£ï¿½Í¬Ê±Ò²ï¿½ï¿½ï¿½ï¿½ECC */
#define SMS4_MAX_LEN	512

/*
* func : tcm_sms4_encrypt()
* Input :  
* 		BYTE *IV : IVï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½128bits
*		BYTE *M : ï¿½ï¿½ï¿½Äµï¿½Ö·
*		UINT32 mLen: ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½
*		BYTE *Sï¿½ï¿½ï¿½ï¿½ï¿½Äµï¿½Ö·
* 		BYTE *key : ï¿½ï¿½Ô¿
* Output :
*		ï¿½ï¿½1 : ï¿½ï¿½ï¿½ï¿½Ê§ï¿½ï¿½
*		Len : ï¿½ï¿½ï¿½Üºó³¤¶ï¿½
* Func Desp : SMS4ï¿½Ä¼ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
*/
unsigned int tcm_sms4_encrypt(unsigned char *IV, unsigned char *M, unsigned int mLen, unsigned char *S, unsigned char *key);


/*
* func : tcm_sms4_decrypt()
* Input :  
* 		BYTE *IV : IVï¿½ï¿½ï¿½ï¿½ï¿½ï¿½Ô¿ï¿½ï¿½ï¿½ï¿½Ò»ï¿½ï¿½ï¿½ï¿½128bits
*		BYTE *M : ï¿½ï¿½ï¿½Äµï¿½Ö·
*		UINT32 mLen: ï¿½ï¿½ï¿½Ä³ï¿½ï¿½ï¿½
*		BYTE *Sï¿½ï¿½ï¿½ï¿½ï¿½Äµï¿½Ö·
* 		BYTE *key : ï¿½ï¿½Ô¿
*		BYTE mode:SMS4Ä£Ê½Ñ¡ï¿½ï¿½
* Output :
*		ï¿½ï¿½1 : ï¿½ï¿½ï¿½ï¿½Ê§ï¿½ï¿½
*		Len : ï¿½ï¿½ï¿½Üºó³¤¶ï¿½
* Func Desp : SMS4ï¿½Ä½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
*/
unsigned int tcm_sms4_decrypt(unsigned char *IV, unsigned char *M, unsigned int mLen, unsigned char *S, unsigned char *key);

#ifdef	__cplusplus
}
#endif


#endif	// HEADER_TCM_ALG_H
